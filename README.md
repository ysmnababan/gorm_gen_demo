# ğŸ§  GORM Gen Demo

This repository demonstrates how to use **GORM Gen**, an official code generation tool for [GORM](https://gorm.io), to automatically create type-safe query builders and models from your database schema.

---

## ğŸš€ Benefits of GORM Gen

Compared to using **regular GORM**, GORM Gen provides:

* **Type-safe queries** â€“ eliminates string-based queries like `db.Where("name = ?", name)`.
* **Auto-generated models and query APIs** â€“ generated Go code reflects your database schema.
* **Less boilerplate** â€“ no need to manually maintain model structs and CRUD methods.
* **Better IDE support** â€“ autocompletion for columns and relationships.
* **Consistent query structure** â€“ encourages functional and composable query code.

Example:

```go
n := q.Navigation
data, err := n.WithContext(ctx).
    Where(n.IsActive.Is(true)).
    Order(n.SortOrder).
    Find()
```

---

## ğŸ§© How to Run

1. **Start the database**

   ```bash
   docker compose up -d
   ```

2. **Initialize schema**

   Connect to the database and run the DDL script:

   ```bash
   psql -h localhost -U postgres -d your_db -f ./initdb/init.sql
   ```

3. **Generate models and queries**

   Before running the app, generate structs and query methods from your DB:

   ```bash
   cd ./src
   go run db_config.go
   ```

   > âš™ï¸ Make sure to adjust the database config in `db_config.go` as needed.

4. **Run the application**

   After generation, you can start the app:

   ```bash
   go run main.go
   ```

   It will use the **functional query API** generated by GORM Gen.

---

## ğŸ§  Notes

* You can use GORM Gen as a drop-in replacement for direct `*gorm.DB` usage in your **repository layer**.
* However, **the generated query objects are structs, not interfaces**, so you **canâ€™t mock them directly** for unit tests.
* To make your code testable:

  * Define an interface in your **service layer** that abstracts repository behavior.
  * Inject a mock implementation for testing instead of directly using the generated query structs.

---

### ğŸ§° Example Interface for Testability

```go
type NavigationRepository interface {
    ListActive(ctx context.Context) ([]*model.Navigation, error)
}
```

Then your service layer can depend on this interface instead of the generated query object.

---